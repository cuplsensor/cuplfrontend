{% extends "base_templates/tag_base.html" %}

{% block headerscripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.3/moment.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.js"></script>
<script>
  function initChart() {
    var ctx = document.getElementById("myChart");
    var plotdata = {{temps|tojson}};
    var linechartdata = {
      datasets: [{
        {% if "rh" in sensor %}
        label: "Relative Humidity (%)",
        backgroundColor: "rgba(153,226,255,0.5)",
        borderColor: "rgba(153,226,235,1)",
        pointBackgroundColor: "rgba(153,226,235,1)",
        {% elif "temp" in sensor %}
        label: "Temperature (Â°C)",
        backgroundColor: "rgba(220,100,94,0.5)",
        borderColor: "rgba(220,100,94,1)",
        pointBackgroundColor: "rgba(220,100,94,1)",
        {% elif "battery" in sensor %}
        label: "Battery (mV)",
        backgroundColor: "rgba(208, 170, 255, 0.5)",
        borderColor: "rgba(208, 170, 255, 1)",
        pointBackgroundColor: "rgba(208, 170, 255, 1)",
        {% endif %}
        data: {{temps|tojson}}
      }]
    }
    var myChart = new Chart(ctx, {
      type: 'line',
      data: linechartdata,
      options: {
        maintainAspectRatio: false,
        scales: {
          xAxes: [{
            type: 'time',
            distribution: 'linear',
            time: {
              tooltipFormat: 'h:mm'
            }

          }],
          yAxes: [{
            ticks: {
              suggestedMin: {{miny}}-4,
              suggestedMax: {{maxy}}+4
            }
          }]
        }
      }
    });
  }
  window.onload = initChart;
</script>
{% endblock %}