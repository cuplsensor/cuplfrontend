{% extends "base_templates/page_base.html" %}  {# base_templates/page_base.html extends base_templates/base.html #}

{% block headerscripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.3/moment.js"></script>
<script type="text/javascript">
var vlogitemsjson = {{vlogitemsjson|tojson}};
var tagurl = {{ url_for('tagview.tag', serial='') }};

function initialise() {
  var tablebody = document.getElementsByTagName("tbody")[0]

  for (var el in vlogitemsjson) {
    var ts = moment(vlogitemsjson[el].timestamp).fromNow();
    var tagserial = vlogitemsjson[el].tag.serial;
    var tr = document.createElement('tr');
    var td_ts = document.createElement('td');
    var td_tagserial = document.createElement('td');
    var ts_text = document.createTextNode(ts);

    var tagserial_anchor = document.createElement('a');
    tagserial_anchor.setAttribute('href', tagurl+tagserial);
    tagserial_anchor.innerHTML = tagserial;

    td_ts.appendChild(ts_text);
    td_tagserial.appendChild(tagserial_anchor);

    tr.appendChild(td_tagserial);
    tr.appendChild(td_ts);

    tablebody.appendChild(tr);
  }

}

window.addEventListener('load', initialise);
</script>
{% endblock %}

{% block title %}
{{ userobj.first_name }}
{% endblock %}
{% block subtitle %}
{% endblock %}

{% block main %}
<section class="section">
  <div class="container">
    <h6>Recently viewed</h6>
    <table class="table">
      <thead>
        <tr>
          <th>Tag</th>
          <th>Timestamp</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
</section>

{% endblock %}
